---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const articles = await getCollection('articles');
  return articles.map(article => ({
    params: { slug: article.slug },
    props: { article },
  }));
}

const { article } = Astro.props;
const { Content } = await article.render();
---

<Base title={article.data.title} description={article.data.description} articleData={{ title: article.data.title, description: article.data.description, date: article.data.date || article.data.created, author: article.data.author, slug: article.slug }}>
  <article class="mx-auto max-w-3xl px-6 py-16">
    <header class="mb-12">
      <div class="flex items-center gap-4 text-sm text-primary-400 mb-4">
        {article.data.date && <time>{article.data.date}</time>}
        {article.data.type && <span class="capitalize px-2 py-0.5 bg-primary-50 rounded">{article.data.type}</span>}
      </div>
      <h1 class="text-3xl md:text-4xl font-bold text-primary-900 leading-tight">
        {article.data.title}
      </h1>
      {article.data.description && (
        <p class="mt-4 text-lg text-primary-600">{article.data.description}</p>
      )}
    </header>

    <div class="prose prose-lg prose-primary max-w-none
      prose-headings:font-semibold prose-headings:text-primary-900
      prose-h2:text-2xl prose-h2:mt-12 prose-h2:mb-4
      prose-h3:text-xl prose-h3:mt-8 prose-h3:mb-3
      prose-p:text-primary-700 prose-p:leading-relaxed
      prose-a:text-accent-600 prose-a:no-underline hover:prose-a:underline
      prose-strong:text-primary-900 prose-strong:font-semibold
      prose-li:text-primary-700
      prose-table:text-sm
      prose-th:bg-primary-50 prose-th:text-primary-900 prose-th:font-semibold prose-th:px-4 prose-th:py-2
      prose-td:px-4 prose-td:py-2 prose-td:border-primary-100
    ">
      <Content />
    </div>

    <footer class="mt-16 pt-8 border-t border-primary-100">
      <a
        href="/articles"
        class="text-sm font-medium text-accent-600 hover:text-accent-700 transition-colors"
      >
        &larr; Back to all articles
      </a>
    </footer>
  </article>
</Base>
